import { ActionConstant, MessageConstants, StatusConstants } from '../../_core/_constants';
export class BaseComponent {
    constructor(translate, url) {
        var _a;
        this.translate = translate;
        this.url = url;
        this.statusConts = new StatusConstants();
        this.isodsExport = true;
        this.globalLang = localStorage.getItem('lang');
        this.skip = 0;
        this.take = 10;
        this.sortOptions = { columns: [{ field: 'estDate', direction: 'Descending' }, { field: 'id', direction: 'Descending' }] };
        this.isAdmin = ((_a = JSON.parse(localStorage.getItem('user'))) === null || _a === void 0 ? void 0 : _a.groupCode) === 'ADMIN';
        this.baseUrl = '';
        this.alert = {
            updateMessage: this.translate.instant(MessageConstants.UPDATE_MESSAGE),
            updateTitle: this.translate.instant(MessageConstants.UPDATE_TITLE),
            createMessage: this.translate.instant(MessageConstants.CREATE_MESSAGE),
            createTitle: this.translate.instant(MessageConstants.CREATE_TITLE),
            deleteMessage: this.translate.instant(MessageConstants.DELETE_MESSAGE),
            deleteTitle: this.translate.instant(MessageConstants.DELETE_TITLE),
            cancelMessage: this.translate.instant(MessageConstants.CANCEL_MESSAGE),
            serverError: this.translate.instant(MessageConstants.SERVER_ERROR),
            deleted_ok_msg: this.translate.instant(MessageConstants.DELETED_OK_MSG),
            created_ok_msg: this.translate.instant(MessageConstants.CREATED_OK_MSG),
            updated_ok_msg: this.translate.instant(MessageConstants.UPDATED_OK_MSG),
            system_error_msg: this.translate.instant(MessageConstants.SYSTEM_ERROR_MSG),
            exist_message: this.translate.instant(MessageConstants.EXIST_MESSAGE),
            choose_farm_message: this.translate.instant(MessageConstants.CHOOSE_FARM_MESSAGE),
            select_order_message: this.translate.instant(MessageConstants.SELECT_ORDER_MESSAGE),
            yes_message: this.translate.instant(MessageConstants.YES_MSG),
            no_message: this.translate.instant(MessageConstants.NO_MSG),
        };
        this.validationGrid = {
            requireField: 'This field is require.',
            textLength: 'Text Length',
        };
        this.editSettingsTree = { allowEditing: false, allowAdding: false, allowDeleting: false, newRowPosition: 'Child', mode: 'Row' };
        this.editSettings = { showDeleteConfirmDialog: false, allowEditing: false, allowAdding: false, allowDeleting: false, mode: 'Normal' };
        this.toolbarOptions = ['ExcelExport', 'Add', 'Edit', 'Delete', 'Cancel', 'Search'];
        this.toolbarOptionsTree = [
            'Add',
            'Delete',
            'Search',
            'ExpandAll',
            'CollapseAll',
            'ExcelExport'
        ];
        this.contextMenuItems = [
            {
                text: 'Add Child',
                iconCss: ' e-icons e-add',
                target: '.e-content',
                id: 'Add-Sub-Item'
            },
            {
                text: 'Delete',
                iconCss: ' e-icons e-delete',
                target: '.e-content',
                id: 'DeleteOC'
            }
        ];
        this.average = (nums) => {
            if (nums.length === 0)
                return 0;
            if (nums.length > 0 && nums) {
                nums = nums.filter(e => e !== null);
                if (nums.length === 0)
                    return 0;
                return nums.reduce((a, b) => (a + b)) / nums.length;
            }
            return 0;
        };
        this.total = (nums) => {
            if (nums.length === 0)
                return 0;
            if (nums.length > 0 && nums) {
                nums = nums.filter(e => e !== null);
                if (nums.length === 0)
                    return 0;
                return nums.reduce((a, b) => (a + b));
            }
            return 0;
        };
        this.baseUrl = url;
        let user = JSON.parse(localStorage.getItem('user'));
        let pageSize = Number(user === null || user === void 0 ? void 0 : user.pageSizeSettingValue) || 10;
        let pageSizesTemp = (user === null || user === void 0 ? void 0 : user.pageSizeSettingList) || ['5', '10', '12', '20'];
        let pageSizes = pageSizesTemp.map(x => {
            if (isNaN(+x))
                return x;
            return +x;
        });
        this.pageSettings = { pageSizes: pageSizes, enableQueryString: true, pageSize: pageSize, currentPage: 1, enableScroll: true };
        this.take = this.pageSettings.pageSize;
    }
    Permission(route) {
        const functionCode = route.snapshot.data.functionCode;
        this.functions = JSON.parse(localStorage.getItem('functions')).filter(x => x.functionCode === functionCode) || [];
        for (const item of this.functions) {
            const toolbarOptions = [];
            for (const action of item.childrens) {
                const optionItem = this.makeAction(action.code);
                toolbarOptions.push(...optionItem.filter(Boolean));
            }
            toolbarOptions.push('Search');
            const uniqueOptionItem = toolbarOptions.filter((elem, index, self) => {
                return index === self.indexOf(elem);
            });
            this.toolbarOptions = uniqueOptionItem;
        }
    }
    PermissionForTreeGrid(route) {
        this.contextMenuItems = [];
        this.functions = JSON.parse(localStorage.getItem('functions'));
        for (const item of this.functions) {
            if (route.snapshot.data.functionCode.includes(item.functionCode)) {
                const toolbarOptionsTree = [];
                for (const action of item.childrens) {
                    const optionItem = this.makeActionTreeGrid(action.code);
                    toolbarOptionsTree.push(...optionItem.filter(Boolean));
                }
                toolbarOptionsTree.push(...['Search',
                    'ExpandAll',
                    'CollapseAll',
                    'ExcelExport']);
                const uniqueOptionItem = toolbarOptionsTree.filter((elem, index, self) => {
                    return index === self.indexOf(elem);
                });
                this.toolbarOptionsTree = uniqueOptionItem;
                break;
            }
        }
    }
    // Đổi action code thanh action của ej2-grid
    makeAction(input) {
        switch (input) {
            case ActionConstant.CREATE:
                this.editSettings.allowAdding = true;
                return ['Add'];
            case ActionConstant.EDIT:
                this.editSettings.allowEditing = false;
                return [];
            case ActionConstant.DELETE:
                this.editSettings.allowDeleting = false;
                return [];
            case ActionConstant.EXCEL_EXPORT:
                return ['ExcelExport'];
            default:
                return [undefined];
        }
    }
    makeActionTreeGrid(input) {
        switch (input) {
            case ActionConstant.EXCEL_EXPORT:
                return ['ExcelExport'];
            case ActionConstant.CREATE:
                this.editSettingsTree.allowAdding = true;
                this.contextMenuItems.push({
                    text: 'Add Child',
                    iconCss: ' e-icons e-add',
                    target: '.e-content',
                    id: 'Add-Sub-Item'
                });
                return ['Add'];
            case ActionConstant.EDIT:
                this.editSettingsTree.allowEditing = false;
                return [undefined];
            case ActionConstant.DELETE:
                this.editSettingsTree.allowDeleting = false;
                this.contextMenuItems.push({
                    text: 'Delete',
                    iconCss: ' e-icons e-delete',
                    target: '.e-content',
                    id: 'DeleteOC'
                });
                return [undefined];
            default:
                return [undefined];
        }
    }
    convertDate(data) {
        if (data instanceof Date) {
            return data.toLocaleDateString();
        }
        return data;
    }
    visibledApply(model) {
        return !(model.id > 0) || !model.applyDate;
    }
    visibledAgree(model) {
        return model.id > 0 && !model.agreeGuid && model.status === this.statusConts.Default;
    }
    visibledReject(model) {
        return model.id > 0 && (model.status === this.statusConts.Agree || model.status === this.statusConts.Default);
    }
    visibledExecute(model) {
        return model.id > 0 && (model.status === this.statusConts.Agree || model.status === this.statusConts.Default);
    }
    visibledInventory(model) {
        return model.id > 0 && (model.status === this.statusConts.Agree || model.status === this.statusConts.Default);
    }
    visibledFinance(model) {
        return model.id > 0 && (model.status === this.statusConts.Agree || model.status === this.statusConts.Default);
    }
    disabledApplyReason(model) {
        return model.id > 0;
    }
    disabledAgreeReason(model) {
        return model.status === this.statusConts.Agree || model.status === this.statusConts.Execute || model.status === this.statusConts.Reject;
    }
    disabledRejectReason(model) {
        return model.status === this.statusConts.Agree || model.status === this.statusConts.Execute || model.status === this.statusConts.Reject;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9waWdmYXJtLWNvcmUvc3JjL2xpYi9jb21wb25lbnRzL2Jhc2UuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE9BQU8sRUFBRSxjQUFjLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFHM0YsTUFBTSxPQUFnQixhQUFhO0lBc0pqQyxZQUNTLFNBQTJCLEVBQzNCLEdBQVc7O1FBRFgsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUFDM0IsUUFBRyxHQUFILEdBQUcsQ0FBUTtRQXZKcEIsZ0JBQVcsR0FBRyxJQUFJLGVBQWUsRUFBRSxDQUFDO1FBQ3BDLGdCQUFXLEdBQUcsSUFBSSxDQUFDO1FBRW5CLGVBQVUsR0FBRyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzFDLFNBQUksR0FBRyxDQUFDLENBQUM7UUFDVCxTQUFJLEdBQUcsRUFBRSxDQUFDO1FBSVYsZ0JBQVcsR0FBRyxFQUFFLE9BQU8sRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDckgsWUFBTyxHQUFHLE9BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLDBDQUFFLFNBQVMsTUFBSyxPQUFPLENBQUM7UUFDMUUsWUFBTyxHQUFHLEVBQUUsQ0FBQTtRQUNaLFVBQUssR0FBRztZQUNOLGFBQWEsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLENBQUM7WUFDdEUsV0FBVyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxD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LElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUUsQ0FBQTtJQUNoSCxDQUFDO0lBQ0QsbUJBQW1CLENBQUMsS0FBSztRQUN2QixPQUFPLEtBQUssQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFBO0lBQ3JCLENBQUM7SUFDRCxtQkFBbUIsQ0FBQyxLQUFLO1FBQ3ZCLE9BQU8sS0FBSyxDQUFDLE1BQU0sS0FBSyxJQUFJLENBQUMsV0FBVyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUE7SUFDekksQ0FBQztJQUNELG9CQUFvQixDQUFDLEtBQUs7UUFDeEIsT0FBTyxLQUFLLENBQUMsTUFBTSxLQUFLLElBQUksQ0FBQyxXQUFXLENBQUMsS0FBSyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxJQUFJLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQTtJQUN6SSxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUcmFuc2xhdGVTZXJ2aWNlIH0gZnJvbSAnQG5neC10cmFuc2xhdGUvY29yZSc7XHJcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlIH0gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiO1xyXG5pbXBvcnQgeyBBY3Rpb25Db25zdGFudCwgTWVzc2FnZUNvbnN0YW50cywgU3RhdHVzQ29uc3RhbnRzIH0gZnJvbSAnLi4vLi4vX2NvcmUvX2NvbnN0YW50cyc7XHJcbmltcG9ydCB7IEZ1bmN0aW9uU3lzdGVtIH0gZnJvbSAnLi4vLi4vX2NvcmUvbW9kZWxzL2FwcGxpY2F0aW9uLXVzZXInO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJhc2VDb21wb25lbnQge1xyXG4gIHN0YXR1c0NvbnRzID0gbmV3IFN0YXR1c0NvbnN0YW50cygpO1xyXG4gIGlzb2RzRXhwb3J0ID0gdHJ1ZTtcclxuICBwYWdlU2V0dGluZ3M6IGFueTtcclxuICBnbG9iYWxMYW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xhbmcnKTtcclxuICBza2lwID0gMDtcclxuICB0YWtlID0gMTA7XHJcbiAgZnVuY3Rpb25OYW1lOiBzdHJpbmc7XHJcbiAgcHJpbnRCeTogc3RyaW5nO1xyXG4gIGF1ZGl0OiBhbnk7XHJcbiAgc29ydE9wdGlvbnMgPSB7IGNvbHVtbnM6IFt7IGZpZWxkOiAnZXN0RGF0ZScsIGRpcmVjdGlvbjogJ0Rlc2NlbmRpbmcnIH0sIHsgZmllbGQ6ICdpZCcsIGRpcmVjdGlvbjogJ0Rlc2NlbmRpbmcnIH1dIH07XHJcbiAgaXNBZG1pbiA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXInKSk/Lmdyb3VwQ29kZSA9PT0gJ0FETUlOJztcclxuICBiYXNlVXJsID0gJydcclxuICBhbGVydCA9IHtcclxuICAgIHVwZGF0ZU1lc3NhZ2U6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5VUERBVEVfTUVTU0FHRSksXHJcbiAgICB1cGRhdGVUaXRsZTogdGhpcy50cmFuc2xhdGUuaW5zdGFudChNZXNzYWdlQ29uc3RhbnRzLlVQREFURV9USVRMRSksXHJcbiAgICBjcmVhdGVNZXNzYWdlOnRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5DUkVBVEVfTUVTU0FHRSksXHJcbiAgICBjcmVhdGVUaXRsZTogdGhpcy50cmFuc2xhdGUuaW5zdGFudChNZXNzYWdlQ29uc3RhbnRzLkNSRUFURV9USVRMRSksXHJcbiAgICBkZWxldGVNZXNzYWdlOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KE1lc3NhZ2VDb25zdGFudHMuREVMRVRFX01FU1NBR0UpLFxyXG4gICAgZGVsZXRlVGl0bGU6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5ERUxFVEVfVElUTEUpLFxyXG4gICAgY2FuY2VsTWVzc2FnZTogdGhpcy50cmFuc2xhdGUuaW5zdGFudChNZXNzYWdlQ29uc3RhbnRzLkNBTkNFTF9NRVNTQUdFKSxcclxuICAgIHNlcnZlckVycm9yOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KE1lc3NhZ2VDb25zdGFudHMuU0VSVkVSX0VSUk9SKSxcclxuICAgIGRlbGV0ZWRfb2tfbXNnOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KE1lc3NhZ2VDb25zdGFudHMuREVMRVRFRF9PS19NU0cpLFxyXG4gICAgY3JlYXRlZF9va19tc2c6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5DUkVBVEVEX09LX01TRyksXHJcbiAgICB1cGRhdGVkX29rX21zZzogdGhpcy50cmFuc2xhdGUuaW5zdGFudChNZXNzYWdlQ29uc3RhbnRzLlVQREFURURfT0tfTVNHKSxcclxuICAgIHN5c3RlbV9lcnJvcl9tc2c6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5TWVNURU1fRVJST1JfTVNHKSxcclxuICAgIGV4aXN0X21lc3NhZ2U6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5FWElTVF9NRVNTQUdFKSxcclxuICAgIGNob29zZV9mYXJtX21lc3NhZ2U6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5DSE9PU0VfRkFSTV9NRVNTQUdFKSxcclxuICAgIHNlbGVjdF9vcmRlcl9tZXNzYWdlOiB0aGlzLnRyYW5zbGF0ZS5pbnN0YW50KE1lc3NhZ2VDb25zdGFudHMuU0VMRUNUX09SREVSX01FU1NBR0UpLFxyXG4gICAgeWVzX21lc3NhZ2U6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5ZRVNfTVNHKSxcclxuICAgIG5vX21lc3NhZ2U6IHRoaXMudHJhbnNsYXRlLmluc3RhbnQoTWVzc2FnZUNvbnN0YW50cy5OT19NU0cpLFxyXG4gIH07XHJcbiAgdmFsaWRhdGlvbkdyaWQgPSB7XHJcbiAgICByZXF1aXJlRmllbGQ6J1RoaXMgZmllbGQgaXMgcmVxdWlyZS4nLFxyXG4gICAgdGV4dExlbmd0aDogJ1RleHQgTGVuZ3RoJyxcclxuICB9O1xyXG4gIFxyXG4gIGZ1bmN0aW9uczogRnVuY3Rpb25TeXN0ZW1bXTtcclxuICBlZGl0U2V0dGluZ3NUcmVlID0geyBhbGxvd0VkaXRpbmc6IGZhbHNlLCBhbGxvd0FkZGluZzogZmFsc2UsIGFsbG93RGVsZXRpbmc6IGZhbHNlLCBuZXdSb3dQb3NpdGlvbjogJ0NoaWxkJywgbW9kZTogJ1JvdycgfTtcclxuICBlZGl0U2V0dGluZ3MgPSB7IHNob3dEZWxldGVDb25maXJtRGlhbG9nOiBmYWxzZSwgYWxsb3dFZGl0aW5nOiBmYWxzZSwgYWxsb3dBZGRpbmc6IGZhbHNlLCBhbGxvd0RlbGV0aW5nOiBmYWxzZSwgbW9kZTogJ05vcm1hbCcgfTtcclxuICB0b29sYmFyT3B0aW9ucyA9IFsnRXhjZWxFeHBvcnQnLCAnQWRkJywgJ0VkaXQnLCAnRGVsZXRlJywgJ0NhbmNlbCcsICdTZWFyY2gnXSBhcyBhbnlbXTtcclxuICB0b29sYmFyT3B0aW9uc1RyZWUgPSBbXHJcbiAgJ0FkZCcsXHJcbiAgJ0RlbGV0ZScsXHJcbiAgJ1NlYXJjaCcsXHJcbiAgJ0V4cGFuZEFsbCcsXHJcbiAgJ0NvbGxhcHNlQWxsJyxcclxuICAnRXhjZWxFeHBvcnQnXHJcbiAgXTtcclxuICBjb250ZXh0TWVudUl0ZW1zID0gW1xyXG4gICAge1xyXG4gICAgICB0ZXh0OiAnQWRkIENoaWxkJyxcclxuICAgICAgaWNvbkNzczogJyBlLWljb25zIGUtYWRkJyxcclxuICAgICAgdGFyZ2V0OiAnLmUtY29udGVudCcsXHJcbiAgICAgIGlkOiAnQWRkLVN1Yi1JdGVtJ1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgdGV4dDogJ0RlbGV0ZScsXHJcbiAgICAgIGljb25Dc3M6ICcgZS1pY29ucyBlLWRlbGV0ZScsXHJcbiAgICAgIHRhcmdldDogJy5lLWNvbnRlbnQnLFxyXG4gICAgICBpZDogJ0RlbGV0ZU9DJ1xyXG4gICAgfVxyXG4gIF07XHJcblxyXG4gIHByb3RlY3RlZCBQZXJtaXNzaW9uKHJvdXRlOiBBY3RpdmF0ZWRSb3V0ZSkge1xyXG4gICAgY29uc3QgZnVuY3Rpb25Db2RlID0gcm91dGUuc25hcHNob3QuZGF0YS5mdW5jdGlvbkNvZGU7XHJcbiAgICB0aGlzLmZ1bmN0aW9ucyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Z1bmN0aW9ucycpKS5maWx0ZXIoeCA9PiB4LmZ1bmN0aW9uQ29kZSA9PT0gZnVuY3Rpb25Db2RlKSB8fCBbXTtcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLmZ1bmN0aW9ucykge1xyXG4gICAgICAgIGNvbnN0IHRvb2xiYXJPcHRpb25zID0gW107XHJcbiAgICAgICAgZm9yIChjb25zdCBhY3Rpb24gb2YgaXRlbS5jaGlsZHJlbnMpIHtcclxuICAgICAgICAgIGNvbnN0IG9wdGlvbkl0ZW0gPSB0aGlzLm1ha2VBY3Rpb24oYWN0aW9uLmNvZGUpO1xyXG4gICAgICAgICAgdG9vbGJhck9wdGlvbnMucHVzaCguLi5vcHRpb25JdGVtLmZpbHRlcihCb29sZWFuKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRvb2xiYXJPcHRpb25zLnB1c2goJ1NlYXJjaCcpO1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZU9wdGlvbkl0ZW0gPSB0b29sYmFyT3B0aW9ucy5maWx0ZXIoKGVsZW0sIGluZGV4LCBzZWxmKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gaW5kZXggPT09IHNlbGYuaW5kZXhPZihlbGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRvb2xiYXJPcHRpb25zID0gdW5pcXVlT3B0aW9uSXRlbTtcclxuICAgIH1cclxuICB9XHJcbiAgcHJvdGVjdGVkIFBlcm1pc3Npb25Gb3JUcmVlR3JpZChyb3V0ZTogQWN0aXZhdGVkUm91dGUpIHtcclxuICAgIHRoaXMuY29udGV4dE1lbnVJdGVtcyA9IFtdO1xyXG4gICAgdGhpcy5mdW5jdGlvbnMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdmdW5jdGlvbnMnKSk7XHJcbiAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5mdW5jdGlvbnMpIHtcclxuICAgICAgaWYgKHJvdXRlLnNuYXBzaG90LmRhdGEuZnVuY3Rpb25Db2RlLmluY2x1ZGVzKGl0ZW0uZnVuY3Rpb25Db2RlKSkge1xyXG4gICAgICAgIGNvbnN0IHRvb2xiYXJPcHRpb25zVHJlZSA9IFtdO1xyXG4gICAgICAgIGZvciAoY29uc3QgYWN0aW9uIG9mIGl0ZW0uY2hpbGRyZW5zKSB7XHJcbiAgICAgICAgICBjb25zdCBvcHRpb25JdGVtID0gdGhpcy5tYWtlQWN0aW9uVHJlZUdyaWQoYWN0aW9uLmNvZGUpO1xyXG4gICAgICAgICAgdG9vbGJhck9wdGlvbnNUcmVlLnB1c2goLi4ub3B0aW9uSXRlbS5maWx0ZXIoQm9vbGVhbikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0b29sYmFyT3B0aW9uc1RyZWUucHVzaCguLi5bJ1NlYXJjaCcsXHJcbiAgICAgICAgICAnRXhwYW5kQWxsJyxcclxuICAgICAgICAgICdDb2xsYXBzZUFsbCcsXHJcbiAgICAgICAgICAnRXhjZWxFeHBvcnQnXSk7XHJcbiAgICAgICAgY29uc3QgdW5pcXVlT3B0aW9uSXRlbSA9IHRvb2xiYXJPcHRpb25zVHJlZS5maWx0ZXIoKGVsZW0sIGluZGV4LCBzZWxmKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gaW5kZXggPT09IHNlbGYuaW5kZXhPZihlbGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRvb2xiYXJPcHRpb25zVHJlZSA9IHVuaXF1ZU9wdGlvbkl0ZW07XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcbiAgLy8gxJDhu5VpIGFjdGlvbiBjb2RlIHRoYW5oIGFjdGlvbiBj4bunYSBlajItZ3JpZFxyXG4gIHByb3RlY3RlZCBtYWtlQWN0aW9uKGlucHV0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBzd2l0Y2ggKGlucHV0KSB7XHJcbiAgICAgIGNhc2UgQWN0aW9uQ29uc3RhbnQuQ1JFQVRFOlxyXG4gICAgICAgIHRoaXMuZWRpdFNldHRpbmdzLmFsbG93QWRkaW5nID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gWydBZGQnXTtcclxuICAgICAgY2FzZSBBY3Rpb25Db25zdGFudC5FRElUOlxyXG4gICAgICAgIHRoaXMuZWRpdFNldHRpbmdzLmFsbG93RWRpdGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgICAgY2FzZSBBY3Rpb25Db25zdGFudC5ERUxFVEU6XHJcbiAgICAgICAgdGhpcy5lZGl0U2V0dGluZ3MuYWxsb3dEZWxldGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBbXTtcclxuICAgICAgY2FzZSBBY3Rpb25Db25zdGFudC5FWENFTF9FWFBPUlQ6XHJcbiAgICAgICAgcmV0dXJuIFsnRXhjZWxFeHBvcnQnXTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gW3VuZGVmaW5lZF07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgbWFrZUFjdGlvblRyZWVHcmlkKGlucHV0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICBzd2l0Y2ggKGlucHV0KSB7XHJcbiAgICAgIGNhc2UgQWN0aW9uQ29uc3RhbnQuRVhDRUxfRVhQT1JUOlxyXG4gICAgICAgIHJldHVybiBbJ0V4Y2VsRXhwb3J0J107XHJcbiAgICAgIGNhc2UgQWN0aW9uQ29uc3RhbnQuQ1JFQVRFOlxyXG4gICAgICAgIHRoaXMuZWRpdFNldHRpbmdzVHJlZS5hbGxvd0FkZGluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0TWVudUl0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgdGV4dDogJ0FkZCBDaGlsZCcsXHJcbiAgICAgICAgICBpY29uQ3NzOiAnIGUtaWNvbnMgZS1hZGQnLFxyXG4gICAgICAgICAgdGFyZ2V0OiAnLmUtY29udGVudCcsXHJcbiAgICAgICAgICBpZDogJ0FkZC1TdWItSXRlbSdcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gWydBZGQnXTtcclxuICAgICAgY2FzZSBBY3Rpb25Db25zdGFudC5FRElUOlxyXG4gICAgICAgIHRoaXMuZWRpdFNldHRpbmdzVHJlZS5hbGxvd0VkaXRpbmcgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gW3VuZGVmaW5lZF07XHJcbiAgICAgIGNhc2UgQWN0aW9uQ29uc3RhbnQuREVMRVRFOlxyXG4gICAgICAgIHRoaXMuZWRpdFNldHRpbmdzVHJlZS5hbGxvd0RlbGV0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0TWVudUl0ZW1zLnB1c2goe1xyXG4gICAgICAgICAgdGV4dDogJ0RlbGV0ZScsXHJcbiAgICAgICAgICBpY29uQ3NzOiAnIGUtaWNvbnMgZS1kZWxldGUnLFxyXG4gICAgICAgICAgdGFyZ2V0OiAnLmUtY29udGVudCcsXHJcbiAgICAgICAgICBpZDogJ0RlbGV0ZU9DJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBbdW5kZWZpbmVkXTtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gW3VuZGVmaW5lZF07XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHRyYW5zbGF0ZTogVHJhbnNsYXRlU2VydmljZSxcclxuICAgIHB1YmxpYyB1cmw6IHN0cmluZ1xyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuYmFzZVVybCA9IHVybDtcclxuICAgIGxldCB1c2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpKTtcclxuICAgIGxldCBwYWdlU2l6ZSA9IE51bWJlcih1c2VyPy5wYWdlU2l6ZVNldHRpbmdWYWx1ZSkgfHwgMTA7XHJcbiAgICBsZXQgcGFnZVNpemVzVGVtcCA9IHVzZXI/LnBhZ2VTaXplU2V0dGluZ0xpc3QgfHwgWyc1JywgJzEwJywgJzEyJywgJzIwJ107XHJcbiAgICBsZXQgcGFnZVNpemVzID0gcGFnZVNpemVzVGVtcC5tYXAoeD0+IHtcclxuICAgICAgaWYgKGlzTmFOKCt4KSkgcmV0dXJuIHg7XHJcbiAgICAgIHJldHVybiAreFxyXG4gICAgfSk7XHJcbiAgICB0aGlzLnBhZ2VTZXR0aW5ncyA9IHsgIHBhZ2VTaXplczogcGFnZVNpemVzLCBlbmFibGVRdWVyeVN0cmluZzogdHJ1ZSwgIHBhZ2VTaXplOiBwYWdlU2l6ZSwgY3VycmVudFBhZ2U6IDEsIGVuYWJsZVNjcm9sbDogdHJ1ZSB9O1xyXG4gICAgdGhpcy50YWtlID0gdGhpcy5wYWdlU2V0dGluZ3MucGFnZVNpemU7XHJcbiAgfVxyXG4gIGNvbnZlcnREYXRlKGRhdGEpIHtcclxuICAgIGlmICggZGF0YSBpbnN0YW5jZW9mIERhdGUgKSB7XHJcbiAgICAgIHJldHVybiAoZGF0YSBhcyBEYXRlKS50b0xvY2FsZURhdGVTdHJpbmcoKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkYXRhO1xyXG4gIH1cclxuICBhdmVyYWdlID0gKG51bXM6IGFueSkgPT4ge1xyXG4gICAgaWYgKG51bXMubGVuZ3RoID09PSAwKSByZXR1cm4gMDtcclxuICAgIGlmIChudW1zLmxlbmd0aCA+IDAgJiYgbnVtcykge1xyXG4gICAgICBudW1zID0gbnVtcy5maWx0ZXIoZSA9PiBlICE9PSBudWxsICk7XHJcbiAgICBpZiAobnVtcy5sZW5ndGggPT09IDApIHJldHVybiAwO1xyXG4gICAgICByZXR1cm4gbnVtcy5yZWR1Y2UoKGEsIGIpID0+IChhICsgYikpIC8gbnVtcy5sZW5ndGg7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gMDtcclxuICB9XHJcbiAgdG90YWwgPSAobnVtczogYW55KSA9PiB7XHJcbiAgICBpZiAobnVtcy5sZW5ndGggPT09IDApIHJldHVybiAwO1xyXG4gICAgaWYgKG51bXMubGVuZ3RoID4gMCAmJiBudW1zKSB7XHJcbiAgICAgIG51bXMgPSBudW1zLmZpbHRlcihlID0+IGUgIT09IG51bGwgKTtcclxuICAgIGlmIChudW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIDA7XHJcbiAgICByZXR1cm4gbnVtcy5yZWR1Y2UoKGEsIGIpID0+IChhICsgYikpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG4gXHJcbiAgdmlzaWJsZWRBcHBseShtb2RlbDogYW55KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gIShtb2RlbC5pZCA+IDApIHx8ICFtb2RlbC5hcHBseURhdGU7XHJcbiAgfVxyXG4gIHZpc2libGVkQWdyZWUobW9kZWw6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIG1vZGVsLmlkID4gMCAmJiAhbW9kZWwuYWdyZWVHdWlkICYmIG1vZGVsLnN0YXR1cyA9PT0gdGhpcy5zdGF0dXNDb250cy5EZWZhdWx0XHJcbiAgfVxyXG4gIHZpc2libGVkUmVqZWN0KG1vZGVsOiBhbnkpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBtb2RlbC5pZCA+IDAgJiYgKG1vZGVsLnN0YXR1cyA9PT0gdGhpcy5zdGF0dXNDb250cy5BZ3JlZSB8fCBtb2RlbC5zdGF0dXMgPT09IHRoaXMuc3RhdHVzQ29udHMuRGVmYXVsdCApXHJcbiAgfVxyXG4gIHZpc2libGVkRXhlY3V0ZShtb2RlbDogYW55KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gbW9kZWwuaWQgPiAwICYmIChtb2RlbC5zdGF0dXMgPT09IHRoaXMuc3RhdHVzQ29udHMuQWdyZWUgfHwgbW9kZWwuc3RhdHVzID09PSB0aGlzLnN0YXR1c0NvbnRzLkRlZmF1bHQgKVxyXG4gIH1cclxuICB2aXNpYmxlZEludmVudG9yeShtb2RlbDogYW55KTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gbW9kZWwuaWQgPiAwICYmIChtb2RlbC5zdGF0dXMgPT09IHRoaXMuc3RhdHVzQ29udHMuQWdyZWUgfHwgbW9kZWwuc3RhdHVzID09PSB0aGlzLnN0YXR1c0NvbnRzLkRlZmF1bHQgKVxyXG4gIH1cclxuICB2aXNpYmxlZEZpbmFuY2UobW9kZWw6IGFueSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIG1vZGVsLmlkID4gMCAmJiAobW9kZWwuc3RhdHVzID09PSB0aGlzLnN0YXR1c0NvbnRzLkFncmVlIHx8IG1vZGVsLnN0YXR1cyA9PT0gdGhpcy5zdGF0dXNDb250cy5EZWZhdWx0IClcclxuICB9XHJcbiAgZGlzYWJsZWRBcHBseVJlYXNvbihtb2RlbCkge1xyXG4gICAgcmV0dXJuIG1vZGVsLmlkID4gMFxyXG4gIH1cclxuICBkaXNhYmxlZEFncmVlUmVhc29uKG1vZGVsKSB7XHJcbiAgICByZXR1cm4gbW9kZWwuc3RhdHVzID09PSB0aGlzLnN0YXR1c0NvbnRzLkFncmVlIHx8IG1vZGVsLnN0YXR1cyA9PT0gdGhpcy5zdGF0dXNDb250cy5FeGVjdXRlIHx8IG1vZGVsLnN0YXR1cyA9PT0gdGhpcy5zdGF0dXNDb250cy5SZWplY3RcclxuICB9XHJcbiAgZGlzYWJsZWRSZWplY3RSZWFzb24obW9kZWwpIHtcclxuICAgIHJldHVybiBtb2RlbC5zdGF0dXMgPT09IHRoaXMuc3RhdHVzQ29udHMuQWdyZWUgfHwgbW9kZWwuc3RhdHVzID09PSB0aGlzLnN0YXR1c0NvbnRzLkV4ZWN1dGUgfHwgbW9kZWwuc3RhdHVzID09PSB0aGlzLnN0YXR1c0NvbnRzLlJlamVjdFxyXG4gIH1cclxufVxyXG4iXX0=